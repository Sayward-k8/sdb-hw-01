## Домашнее задание к занятию «`Базы данных, их типы`» - ` Игонин В.А.`

# Задание 1. СУБД

# Кейс

**Крупная строительная компания, которая также занимается проектированием и девелопментом, решила создать правильную архитектуру для работы с данными. Ниже представлены задачи, которые необходимо решить для каждой предметной области.**

**Какие типы СУБД, на ваш взгляд, лучше всего подойдут для решения этих задач и почему?**

  1.1. Бюджетирование проектов с дальнейшим формированием финансовых аналитических отчётов и прогнозирования рисков. СУБД должна гарантировать целостность и чёткую структуру данных.
  
  1.1.* Хеширование стало занимать длительно время, какое API можно использовать для ускорения работы?
  
  1.2. Под каждый девелоперский проект создаётся отдельный лендинг, и все данные по лидам стекаются в CRM к маркетологам и менеджерам по продажам. Какой тип СУБД лучше использовать для лендингов и для CRM? СУБД должны быть гибкими и быстрыми.
  
  1.2.* Можно ли эту задачу закрыть одной СУБД? И если да, то какой именно СУБД и какой реализацией?
  
  1.3. Отдел контроля качества решил создать базу по корпоративным нормам и правилам, обучающему материалу и так далее, сформированную согласно структуре компании. СУБД должна иметь простую и понятную структуру.
  
  1.3.* Можно ли под эту задачу использовать уже существующую СУБД из задач выше и если да, то как лучше это реализовать?
  
  1.4. Департамент логистики нуждается в решении задач по быстрому формированию маршрутов доставки материалов по объектам и распределению курьеров по маршрутам с доставкой документов. СУБД должна уметь быстро работать со связями.
  
  1.4.* Можно ли к этой СУБД подключить отдел закупок или для них лучше сформировать свою СУБД в связке с СУБД логистов?
  
  1.5.* Можно ли все перечисленные выше задачи решить, используя одну СУБД? Если да, то какую именно?

Приведите ответ в свободной форме.

# Решение 1
  * 1.1

<details> 
  
  -  1.1. Бюджетирование проектов с дальнейшим формированием финансовых аналитических отчётов и прогнозирования рисков. СУБД должна гарантировать целостность и чёткую структуру данных.
  
Согласно материалам лекции, для бюджетирования проектов идеально подойдут реляционные СУБД, так как они гарантируют целостность и чёткую структуру данных.
Используются для работы с транзакциями. Например PostgreSQL

  - 1.1.* Хеширование стало занимать длительно время, какое API можно использовать для ускорения работы?

Для ускорения хеширования можно использовать индексирование, например, я почитал, что в PostgreSQL существуют Hash-индексы, они предназначены в первую очередь для нагрузки с большим количеством операций SELECT и UPDATE, которые выполняют сканирование с проверкой равенства для больших таблиц. 

</details>

  * 1.2 

<details> 
  
  - 1.2 Под каждый девелоперский проект создаётся отдельный лендинг, и все данные по лидам стекаются в CRM к маркетологам и менеджерам по продажам. Какой тип СУБД лучше использовать для лендингов и для CRM? СУБД должны быть гибкими и быстрыми.
  
  Для лендингов можно использовать документо-ориентированные СУБД NoSQL
  Для CRM требуется структурированные данные о клиентах, транзакциях, поэтому нужны реляционные СУБД, например можно использовать PostgreSQL или MongoDB

  - 1.2* Можно ли эту задачу закрыть одной СУБД? И если да, то какой именно СУБД и какой реализацией?
  
  Да, можно использовать одну СУБД, например, MongoDB, для управления данными как лендингов, так и CRM.

</details>

  *  1.3

<details> 
  
  - 1.3 Отдел контроля качества решил создать базу по корпоративным нормам и правилам, обучающему материалу и так далее, сформированную согласно структуре компании. СУБД должна иметь простую и понятную структуру.
  
  Для выполнения данной задачи подойдет реляционная СУБД, например, MySQL или PostgreSQL

  - 1.3* Можно ли под эту задачу использовать уже существующую СУБД из задач выше и если да, то как лучше это реализовать?

  Да, можно использовать ту же СУБД, что и для бюджетирования проектов, в пунтке 1.1 (например, PostgreSQL), для обеспечения целостности данных и упрощения интеграции различных данных.

</details>

  *  1.4 
  
<details> 
  
  - 1.4 Департамент логистики нуждается в решении задач по быстрому формированию маршрутов доставки материалов по объектам и распределению курьеров по маршрутам с доставкой документов. СУБД должна уметь быстро работать со связями.

  Можно использовать реляционную СУБД с поддержкой геоданных, например PostgreSQL + PostGIS, позволяющую эффективно работать со сложными запросами маршрутизации и распределения.
  
  - 1.4*  Можно ли к этой СУБД подключить отдел закупок или для них лучше сформировать свою СУБД в связке с СУБД логистов?

Да, отдел закупок может использовать ту же СУБД, что и логистика, что упростит интеграцию и аналитику, если в процессах много общих данных и зависимостей.

</details>

  * 1.5*

<details> 
  
  - 1.5*  Можно ли все перечисленные выше задачи решить, используя одну СУБД? Если да, то какую именно?
  
  Использование одной СУБД для всех вышеперечисленных задач возможно. Например PostgreSQL

</details>

# Задание 2. Транзакции

  2.1. Пользователь пополняет баланс счёта телефона, распишите пошагово, какие действия должны произойти для того, чтобы транзакция завершилась успешно. Ориентируйтесь на шесть действий.
  
# Решение 2

<details> 

  2.1. Пополнение баланса счёта телефона
  
Транзакция в БД банка (списание/зачисление денег)
  1. Инициация транзакции в БД банка
  2. Проверка доступности средств и валидности данных

Проверка достаточности средств на счёте/карте, лимитов и тд
 
  3. Списание средств с источника оплаты

Списание средств происходит только в БД банка. Оператор лишь получает уведомление об уже совершённом списании. 

  4. Зачисление средств на счёт оператора связи
  5. Фиксация транзакции (COMMIT)

Если все предыдущие шаги выполнены успешно и без ошибок, транзакция подтверждается — изменения записываются в базу данных окончательно.

  6. Уведомление 

Банк отправляет подтверждение (чек) оператору связи

Транзакция в БД оператора (начисление услуг)
  1. Инициация транзакции в БД оператора
  2. Проверка валидности данных

Проверка существования номера телефона, активности симкарты 

  3. Фиксация поступления средств     
  4. Начисление средств на баланс телефона(обновление внутреннего баланса в БД оператора)
  5. Фиксация транзакции (COMMIT)
  6. Уведомление пользователя и логирование
  
</details> 

# Задание 3. SQL vs NoSQL

  3.1. Напишите пять преимуществ SQL-систем по отношению к NoSQL.
  
  3.1.* Какие, на ваш взгляд, преимущества у NewSQL систем перед SQL и NoSQL.

Приведите ответ в свободной форме.

# Решение 3
3.1
<details> 

  3.1. Напишите пять преимуществ SQL-систем по отношению к NoSQL.
  
  1. Поддержка транзакций - обеспечивает надёжность операций с данными
  2. Строгая схема данных - гарантирует целостность данных и упрощает управление.
  3. Стандартный язык запросов - SQL широко известен 
  4. Совместимость - множество инструментов и библиотек поддерживают SQL-базы данных
  5. Созревшие технологии: SQL-системы давно на рынке, имеют обширную экосистему, инструменты и поддержку. 

</details> 

3.1.*
<details> 

  3.1.* Какие, на ваш взгляд, преимущества у NewSQL систем перед SQL и NoSQL.

NewSQL как гибрид, который берет лучшее от SQL и NoSQL:

  1. Горизонтальная масштабируемость
  2. Высокая доступность и отказоустойчивость
  3. Производительность
  4. Поддержка ACID
  5. Мощный язык запросов
  6. Согласованность  

</details> 

# Задание 4. Кластеры

Необходимо производить большое количество вычислений при работе с огромным количеством данных, под эту задачу выделено 1000 машин.
  
  * На основе какого критерия будете выбирать тип СУБД и какая модель распределённых вычислений здесь справится лучше всего и почему?

Приведите ответ в свободной форме.

# Решение 4

<details> 

# При выделении 1000 машин для вычислений над огромными данными, выбор технологии определяется компромиссом между согласованностью (C), доступностью (A) и скоростью (Latency). Теоремы CAP и PACELC дают четкую рамку для этого выбора.

C (Consistency) — все узлы видят одни и те же данные в один момент времени.
A (Availability) — система всегда даёт ответ (пусть даже не самый свежий).
P (Partition Tolerance) — система работает даже при обрывах связи между узлами.

  * ЕСЛИ вычисления критически зависят от полной и мгновенной согласованности данных

По теореме CAP: Это CP-системы (Consistency, Partition Tolerance), при сетевом сбое они предпочтут остановить запись на часть узлов, но не допустят противоречий.
По PACELC: Это PC/EC-системы. Даже в нормальном режиме тормозит (L) ради строгой согласованности (C), для того чтобы все узлы кластера увидели одинаковые данные.

NewSQL(Google Spanner, CockroachDB)


  * ЕСЛИ вычисления работают с потоками событий, где важнее обработать и записать всё без задержек

По теореме CAP: AP-системы (Availability, Partition Tolerance), где при обрыве связи все узлы продолжают принимать данные, а согласованность восстанавливается позже (eventual consistency).
По PACELC: PA/EL. Почти точно так же как и в АР, данные получаются быстро, а согласовываются позже.

NoSQL (Apache Cassandra, ScyllaDB)

# Модель распределённых вычислений, выбор определяется характером данных и требований ко времени ответа.

  - для потоковых вычислений чаще выбирают AP-хранилища, чтобы не тормозить запись. Apache Spark (модель MapReduce)
  - для пакетной аналитики над финансовыми данными — CP-хранилища, чтобы отчеты были точными. Apache Flink (или Spark Streaming)
  
</details> 
